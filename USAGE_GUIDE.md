# 后台打开功能使用指南

## 📖 功能说明

### 什么是"后台打开"?

后台打开是指在新标签页打开链接时,**保持当前页面为活动标签**,新标签在后台打开。这样你可以继续浏览当前页面,稍后再查看新打开的标签。

### 适用场景

✅ **适合使用后台打开**:
- 浏览论坛帖子列表,一次打开多个感兴趣的帖子
- 阅读长文时,需要打开文中提到的参考链接
- 收集资料时,批量打开多个链接

❌ **不适合后台打开**:
- 需要立即查看新页面内容
- 点击导航链接进行页面跳转
- 单次只打开一个链接

## 🎛️ 设置选项

### 1. 默认模式

设置新标签页的默认打开行为:

#### 前台打开
- **行为**: 新标签立即激活,焦点切换到新标签
- **适用**: 需要立即查看新页面内容
- **图标**: 👁️ (眼睛)

#### 主题帖后台
- **行为**: 打开主题帖时在后台,其他链接前台打开
- **适用**: 浏览论坛时批量打开帖子
- **图标**: 💬 (对话框)

#### 全部后台
- **行为**: 所有新标签都在后台打开
- **适用**: 需要持续浏览当前页面
- **图标**: ▦ (网格)

### 2. 悬浮球设置

#### 显示悬浮球
- **开启**: 在页面右侧显示圆形悬浮按钮
- **关闭**: 隐藏悬浮球,仅使用默认模式

#### 固定位置
- **开启**: 锁定悬浮球位置,无法拖动
- **关闭**: 可以自由拖动悬浮球到任意位置

#### 重置位置
- 点击按钮将悬浮球恢复到默认位置(右侧中上部)

#### 悬浮球可切换的模式
- 选择哪些模式可以通过悬浮球快速切换
- **必须至少选择2个**,否则无法切换

## 🎯 操作指南

### 设置默认模式

1. 打开脚本设置界面
2. 找到"后台打开"分栏
3. 点击"默认模式"下的三个按钮之一
4. 选中的按钮会变为绿色

### 使用悬浮球快速切换

1. 确保"显示悬浮球"开关已打开
2. 在Discourse论坛页面查看悬浮球(右侧)
3. **点击悬浮球**: 在允许的模式间循环切换
4. **悬停查看**: 显示当前模式名称
5. **拖动悬浮球**: 移动到喜欢的位置(非固定模式下)

### 自定义悬浮球位置

#### 拖动悬浮球
1. 确保"固定位置"开关是**关闭**的
2. 鼠标按住悬浮球
3. 拖动到想要的位置
4. 松开鼠标,位置自动保存

#### 固定悬浮球
1. 调整好位置后
2. 打开"固定位置"开关
3. 悬浮球将锁定,无法拖动

#### 重置位置
- 如果悬浮球位置不理想,点击"重置位置"按钮恢复默认

### 设置可切换模式

1. 在"悬浮球可切换的模式"区域
2. 点击卡片选择/取消选择模式
3. **已选中的卡片**: 绿色边框+右上角对勾
4. **至少保留2个选项**: 确保可以切换

## 💡 使用技巧

### 技巧1: 批量浏览帖子
```
设置: 主题帖后台
操作: 在帖子列表页,按住Ctrl点击多个帖子标题
效果: 所有帖子在后台打开,当前页面保持活动
```

### 技巧2: 临时切换模式
```
不想修改默认设置?
使用悬浮球快速切换:
  点击一次 → 切换到下一个模式
  点击两次 → 再次切换
```

### 技巧3: 阅读长文
```
设置: 全部后台
场景: 阅读长篇论坛帖子
操作: 点击帖子中的参考链接
效果: 链接在后台打开,继续阅读当前帖子
```

### 技巧4: 个性化悬浮球
```
拖动悬浮球到不遮挡内容的位置
常见位置:
  - 右上角(靠近浏览器工具栏)
  - 右中(默认)
  - 右下角(靠近滚动条)
```

### 技巧5: 简化悬浮球选项
```
如果只需要两种模式:
  1. 取消不需要的模式卡片
  2. 只保留常用的2个
  3. 悬浮球切换更快捷
```

## ⚠️ 注意事项

### 最少2个可切换模式

**为什么必须至少选2个?**
- 悬浮球的作用是"切换"模式
- 只有1个模式无法切换
- 系统会阻止取消最后第二个选项

**视觉提示**:
- 只剩2个选中时,卡片边框会呼吸闪烁
- 鼠标变为禁止图标
- 显示"至少保留2个选项以便切换"提示

### 悬浮球拖动性能

**正常情况**:
- 悬浮球跟随鼠标流畅移动
- 使用requestAnimationFrame优化

**如果卡顿**:
- 可能是设备性能较低
- 可以开启"固定位置"减少计算

### 跨页面同步

- 悬浮球位置会在所有Discourse页面间同步
- 在一个页面调整位置,其他页面自动更新
- 使用GM存储实现

### 浏览器兼容性

✅ **支持的浏览器**:
- Chrome/Edge (推荐)
- Firefox
- Safari
- Opera

❌ **已知限制**:
- 某些浏览器可能不支持毛玻璃效果
- IE浏览器不支持

## 🐛 常见问题

### Q: 悬浮球不显示?
**A**: 检查"显示悬浮球"开关是否打开

### Q: 悬浮球无法拖动?
**A**: 检查"固定位置"开关是否关闭

### Q: 为什么无法取消某个模式卡片?
**A**: 必须保留至少2个可切换模式,当前只剩2个了

### Q: 悬浮球位置跑偏了?
**A**: 点击"重置位置"按钮恢复默认

### Q: 设置没有生效?
**A**:
1. 检查是否保存设置
2. 刷新页面重试
3. 查看浏览器控制台是否有错误

### Q: 悬浮球颜色是什么意思?
**A**:
- 灰色: 前台打开模式
- 蓝色: 主题帖后台模式
- 绿色: 全部后台模式

## 📚 相关文档

- [UI优化总结](./UI_OPTIMIZATION_SUMMARY.md) - 了解设计细节
- [UI预览](./UI_PREVIEW.md) - 查看界面布局
- [项目README](./README.md) - 脚本整体说明

---

**帮助改进**: 如果本指南有不清楚的地方,欢迎提Issue反馈!
