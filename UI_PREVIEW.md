# UI设计预览 - 后台打开功能

## 🎨 整体布局

```
┌─────────────────────────────────────────────────────────┐
│ 后台打开                                                  │
├─────────────────────────────────────────────────────────┤
│ ℹ️ 后台打开是指在新标签页打开链接时,保持当前页面为活   │
│   动标签,新标签在后台打开                               │
├─────────────────────────────────────────────────────────┤
│                                                          │
│ 默认模式                                                 │
│ ┌────────────────────────────────────────────────────┐ │
│ │  ┌──────────┐  ┌──────────┐  ┌──────────┐         │ │
│ │  │ 前台打开 │  │主题帖后台│  │ 全部后台 │         │ │
│ │  │新标签立即│  │打开主题帖│  │所有新标签│         │ │
│ │  │   激活   │  │时在后台  │  │都在后台  │         │ │
│ │  └──────────┘  └──────────┘  └──────────┘         │ │
│ │     (灰色)      (绿色高亮)      (灰色)             │ │
│ └────────────────────────────────────────────────────┘ │
│                                                          │
├─────────────────────────────────────────────────────────┤
│                                                          │
│ 悬浮球设置                                               │
│ ┌────────────────────────────────────────────────────┐ │
│ │                                                     │ │
│ │ 显示悬浮球                                    [ON] │ │
│ │ 在页面上显示快速切换按钮                          │ │
│ │ ─────────────────────────────────────────────────  │ │
│ │ 固定位置                                      [OFF]│ │
│ │ 禁用拖动,锁定悬浮球位置                           │ │
│ │                                                     │ │
│ │ [ 重置位置 ]                                       │ │
│ │                                                     │ │
│ │ 悬浮球可切换的模式                                 │ │
│ │ 至少保留2个选项以便切换                            │ │
│ │                                                     │ │
│ │ ┌─────────┐  ┌─────────┐  ┌─────────┐           │ │
│ │ │    👁️   │  │    💬   │✓ │    ▦    │✓          │ │
│ │ │         │  │         │  │         │            │ │
│ │ │前台打开 │  │主题帖后台│  │全部后台 │            │ │
│ │ │新标签立即│  │打开主题帖│  │所有新标签│           │ │
│ │ │  激活   │  │时在后台  │  │都在后台 │            │ │
│ │ └─────────┘  └─────────┘  └─────────┘           │ │
│ │   (未选中)     (已选中)      (已选中)             │ │
│ └────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

## 🎯 分段控制器详细设计

### 默认状态
```
┌──────────────────────────────────────────────┐
│ ┌──────────┬──────────┬──────────┐          │
│ │ 前台打开 │主题帖后台│ 全部后台 │          │
│ │新标签立即│打开主题帖│所有新标签│          │
│ │   激活   │时在后台  │都在后台  │          │
│ └──────────┴──────────┴──────────┘          │
└──────────────────────────────────────────────┘
```

### Hover状态 (鼠标悬停在"主题帖后台")
```
┌──────────────────────────────────────────────┐
│ ┌──────────┬──────────┬──────────┐          │
│ │ 前台打开 │主题帖后台│ 全部后台 │          │
│ │新标签立即│打开主题帖│所有新标签│          │
│ │   激活   │时在后台  │都在后台  │          │
│ └──────────┴──────────┴──────────┘          │
│              ↑ 浅灰背景                       │
└──────────────────────────────────────────────┘
```

### 选中状态 ("主题帖后台"被选中)
```
┌──────────────────────────────────────────────┐
│ ┌──────────┬──────────┬──────────┐          │
│ │ 前台打开 │主题帖后台│ 全部后台 │          │
│ │新标签立即│打开主题帖│所有新标签│          │
│ │   激活   │时在后台  │都在后台  │          │
│ └──────────┴──────────┴──────────┘          │
│              ↑ 绿色背景+白字+阴影             │
└──────────────────────────────────────────────┘
```

## 🎴 模式卡片选择器详细设计

### 三张卡片布局
```
┌──────────┐   ┌──────────┐   ┌──────────┐
│          │   │     ✓    │   │     ✓    │  ← 右上角对勾(选中时)
│   👁️    │   │   💬     │   │   ▦      │  ← 图标
│          │   │          │   │          │
│ 前台打开 │   │主题帖后台│   │全部后台  │  ← 标题
│新标签立即│   │打开主题帖│   │所有新标签│  ← 说明
│  激活    │   │时在后台  │  │都在后台  │
└──────────┘   └──────────┘   └──────────┘
  灰色边框      绿色边框       绿色边框
```

### 卡片状态说明

#### 未选中状态
```
┌──────────┐
│          │  边框: 浅灰色 (#e1e4e8)
│   👁️    │  背景: 输入框背景色
│          │  图标: 灰色
│ 前台打开 │
│新标签立即│
│  激活    │
└──────────┘
```

#### Hover状态
```
┌──────────┐
│          │  边框: 绿色 (#67c23a)
│   👁️    │  背景: 悬停背景色
│    ↑     │  向上浮动2px
│ 前台打开 │  轻微阴影
│新标签立即│
│  激活    │
└──────────┘
```

#### 选中状态
```
┌──────────┐
│     ✓    │  边框: 绿色加粗
│   👁️    │  背景: 对话框背景
│          │  图标: 绿色
│ 前台打开 │  绿色阴影光晕
│新标签立即│  右上角绿色对勾
│  激活    │
└──────────┘
```

#### 最小需求状态(只剩2张选中时)
```
┌══════════┐
║     ✓    ║  双层边框呼吸动画
║   💬     ║  半透明(opacity: 0.8)
║          ║  cursor: not-allowed
║主题帖后台║  tooltip: "至少保留2个选项"
║打开主题帖║
║时在后台  ║
└══════════┘
```

## 🎈 悬浮球设计

### 正常状态(主题帖模式)
```
   ┌─────┐
   │ ︙   │  ← 拖动手柄(3px白色条)
  ┌───────┐
 │         │
 │   💬    │  ← 图标
 │         │
  └───────┘
    蓝色背景
    毛玻璃效果
    阴影
```

### Hover状态
```
   ┌─────┐
   │ ︙   │
  ┌───────┐
 │  ╔═══╗ │  放大108%
 │  ║💬 ║ │  增强阴影
 │  ╚═══╝ │
  └───────┘
  ┌─────────┐
  │主题帖后台│ ← Tooltip淡入
  └─────────┘
```

### 拖动中状态
```
      ┌─────┐
      │ ︙   │
     ┌───────┐
    │  ═══  │  放大110%
    │ ║💬 ║ │  最深阴影
    │  ═══  │  cursor: grabbing
     └───────┘
       蓝色
       抖动效果
```

### 固定模式状态
```
  ┌───────┐
 │         │  无拖动手柄
 │   💬    │  hover仅轻微放大(102%)
 │         │  cursor: default
  └───────┘
```

## 🎨 颜色规范

### 日间模式
| 元素 | 颜色值 | 示例 |
|------|--------|------|
| 主色调 | #67c23a | 🟢 绿色 |
| 信息框边框 | #67c23a | 🟢 绿色 |
| 选中项背景 | #67c23a | 🟢 绿色 |
| 选中项文字 | #ffffff | ⚪ 白色 |
| 未选中文字 | #6c757d | ⚫ 深灰 |
| 边框 | #e1e4e8 | ⚪ 浅灰 |

### 夜间模式
| 元素 | 颜色值 | 示例 |
|------|--------|------|
| 主色调 | #4a9e2a | 🟢 深绿 |
| 信息框边框 | #4a9e2a | 🟢 深绿 |
| 选中项背景 | #4a9e2a | 🟢 深绿 |
| 对话框背景 | #1e1e1e | ⚫ 深黑 |
| 区块背景 | #2a2a2a | ⚫ 灰黑 |

### 悬浮球模式色
| 模式 | 颜色值 | 半透明度 |
|------|--------|----------|
| 前台打开 | #909399 | 85% |
| 主题帖后台 | #409eff | 85% |
| 全部后台 | #67c23a | 85% |

## ✨ 动画效果

### 1. 分段控制器切换
```
时长: 200ms
缓动: cubic-bezier(0.4, 0, 0.2, 1)
属性: background-color, color, box-shadow
```

### 2. 卡片Hover
```
时长: 200ms
缓动: ease
属性:
  - border-color
  - background-color
  - transform: translateY(-2px)
  - box-shadow
```

### 3. 卡片选中对勾
```
时长: 200ms
缓动: cubic-bezier(0.4, 0, 0.2, 1)
属性:
  - opacity: 0 → 1
  - transform: scale(0.5) → scale(1)
```

### 4. 悬浮球拖动
```
使用 requestAnimationFrame
实时跟随鼠标位置
60fps 流畅动画
```

### 5. 悬浮球缩放
```
时长: 200ms
缓动: cubic-bezier(0.4, 0, 0.2, 1)
属性:
  - transform: scale(1) → scale(1.08)
  - box-shadow (渐变增强)
```

### 6. Tooltip淡入
```
时长: 200ms
缓动: ease
属性:
  - opacity: 0 → 1
  - transform: translateY(4px) → translateY(0)
```

### 7. 最小需求呼吸动画
```
时长: 2s
循环: infinite
缓动: ease-in-out
属性:
  - opacity: 0.3 → 0.6 → 0.3
```

## 📱 响应式适配

### 桌面端 (>768px)
- 卡片横向排列,3列布局
- 分段控制器横向排列
- 悬浮球44px直径

### 平板端 (560px - 768px)
- 卡片横向排列,可能换行
- 分段控制器横向排列
- 悬浮球44px直径

### 移动端 (<560px)
- 卡片垂直堆叠,单列布局
- 分段控制器垂直堆叠
- 悬浮球44px直径(保持不变)

## 🎯 交互流程

### 场景1: 修改默认模式
```
1. 用户点击"全部后台"按钮
   ↓
2. 按钮立即变为绿色背景+白字
   ↓
3. 其他按钮变为灰色背景
   ↓
4. 数据保存到存储
   ↓
5. 悬浮球(如果显示)同步更新为绿色
```

### 场景2: 取消选择模式卡片(最后2张时)
```
1. 用户点击已选中的"主题帖后台"卡片
   ↓
2. 检测到只剩2张选中
   ↓
3. checkbox自动回到选中状态(阻止取消)
   ↓
4. 卡片边框开始呼吸动画
   ↓
5. 鼠标变为禁止图标
   ↓
6. Tooltip显示"至少保留2个选项以便切换"
```

### 场景3: 拖动悬浮球
```
1. 鼠标按下悬浮球
   ↓
2. 添加.dnt-fb-dragging类
   ↓
3. 球体放大至110%,阴影加深
   ↓
4. 鼠标移动,球体实时跟随(RAF优化)
   ↓
5. 鼠标释放
   ↓
6. 移除.dnt-fb-dragging类
   ↓
7. 球体恢复原大小
   ↓
8. 保存新位置到存储(视口比例)
```

---

**提示**: 实际效果请在浏览器中运行脚本查看,本文档仅为ASCII艺术预览。
